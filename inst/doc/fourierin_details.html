<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Guillermo Basulto-Elias" />

<meta name="date" content="2023-12-08" />

<title>‘fourierin’ package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">‘fourierin’ package</h1>
<h4 class="author">Guillermo Basulto-Elias</h4>
<h4 class="date">2023-12-08</h4>



<p>This is a package in <code>R</code> to numerically calculate
Fourier-type integrals of multivariate functions with compact support
evaluated at regular grids. Specifically, integrals of the type</p>
<p><span class="math display">\[
I \left[f(t), \boldsymbol{a}, \boldsymbol{b};r, s \right]
  = \left[ \frac{|s|}{(2\pi)^{1 - r}}\right]^{n/2}
  \int_{a_1}^{b_1}\int_{a_2}^{b_2}\cdots\int_{a_n}^{b_n}
  f(\boldsymbol{t})e^{\imath s
  \langle \boldsymbol{w}, \boldsymbol{t}\rangle} \text{d}\boldsymbol{t},
\]</span></p>
<!--
<img src="eq01_main_eq.png" width="600px" />
-->
<p>where,</p>
<p><span class="math inline">\(\boldsymbol{a} = (a_1, \ldots,
a_n)\)</span>, <span class="math inline">\(\boldsymbol{b} = (b_1,
\ldots, b_n)\)</span>, <span class="math inline">\(\boldsymbol{t} =
(t^{(1)}, \ldots, t^{(n)})\)</span>, <span class="math inline">\(\boldsymbol{w} = (w^{(1)}, \ldots,
w^{(n)})\)</span>, <span class="math inline">\(a_l \leq t^{(l)} \leq
b_l\)</span>, <span class="math inline">\(c_l \leq w^{(l)} \leq
c_l\)</span>.</p>
<!--
<img src="eq02_details.png" width="200px" />
-->
<p>Common values for <em>r</em> are -1, 0 and -1, while common values
for <em>s</em> are <em>-2</em>, -1, 1 and <em>2</em>. For example, if
<em>f</em> is a density function, <em>s = 1</em> and <em>r = 1</em>
could be used to obtain the characteristic function of <em>f</em>.
Conversely, if <em>f</em> is the characteristic function of a
probability density function, then <em>r = -1</em> and <em>s = -1</em>
could be used to recover the density.</p>
<p>The implementation of this algorithm is the one described in
Inverarity (2002), Fast Computation of multidimensional Integrals (at
‘epubs.siam.org/doi/abs/10.1137/S106482750138647X’).</p>
<p>Some examples (also found in documentation).</p>
<div id="example-0-speed-tests" class="section level2">
<h2>Example 0: Speed tests</h2>
<p>Below it is an example of univariate continuous Fourier
transform.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(fourierin)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## Test speed at several resolutions</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>resolution <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## Function to be tested</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>myfnc <span class="ot">&lt;-</span> <span class="cf">function</span>(t) <span class="fu">exp</span>(<span class="sc">-</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## Aux. function</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>compute_times <span class="ot">&lt;-</span> <span class="cf">function</span>(resol){</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  rbenchmark<span class="sc">::</span><span class="fu">benchmark</span>(</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    <span class="at">yes =</span> <span class="fu">fourierin_1d</span>(<span class="at">f =</span> myfnc, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, resol),</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    <span class="at">no =</span> <span class="fu">fourierin_1d</span>(<span class="at">f =</span> myfnc, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, resol,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>                      <span class="at">use_fft =</span> <span class="cn">FALSE</span>),</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    <span class="at">replications =</span> reps) <span class="sc">%&gt;%</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">FFT =</span> test, <span class="at">time =</span> elapsed) <span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time =</span> time<span class="sc">*</span><span class="fl">1e3</span><span class="sc">/</span>reps, <span class="at">resolution =</span> resol)</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>}</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>resolution <span class="sc">%&gt;%</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>    <span class="fu">map_df</span>(compute_times) <span class="sc">%&gt;%</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">resolution =</span> <span class="fu">as.factor</span>(resolution)) <span class="sc">%&gt;%</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(resolution, time, <span class="at">color =</span> FFT)) <span class="sc">+</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> FFT)) <span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> FFT, <span class="at">group =</span> FFT)) <span class="sc">+</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;time (in milliseconds)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we present an example using a bivariate function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="do">## Load packages</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">library</span>(fourierin)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="do">## Test speed at several resolutions</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>resolution <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="do">## Bivariate function to be tested</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>myfnc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x[, <span class="dv">1</span>])<span class="sc">*</span><span class="fu">dnorm</span>(x[, <span class="dv">2</span>])</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="do">## Aux. function</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>compute_times <span class="ot">&lt;-</span> <span class="cf">function</span>(resol){</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  resol <span class="ot">&lt;-</span> <span class="fu">rep</span>(resol, <span class="dv">2</span>)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  rbenchmark<span class="sc">::</span><span class="fu">benchmark</span>(</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>    <span class="at">yes =</span> <span class="fu">fourierin</span>(myfnc,</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>                      <span class="at">lower_int =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">6</span>), <span class="at">upper_int =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>),</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>                      <span class="at">lower_eval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>), <span class="at">upper_eval =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>                      <span class="at">const_adj =</span> <span class="dv">1</span>, <span class="at">freq_adj =</span> <span class="dv">1</span>,</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>                      <span class="at">resolution =</span> resol),</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>    <span class="at">no =</span> <span class="fu">fourierin</span>(myfnc,</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>                      <span class="at">lower_int =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">6</span>), <span class="at">upper_int =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>),</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>                      <span class="at">lower_eval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>), <span class="at">upper_eval =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>                      <span class="at">const_adj =</span> <span class="dv">1</span>, <span class="at">freq_adj =</span> <span class="dv">1</span>,</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>                      <span class="at">resolution =</span> resol, <span class="at">use_fft =</span> <span class="cn">FALSE</span>),</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>    <span class="at">replications =</span> reps) <span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">FFT =</span> test, <span class="at">time =</span> elapsed) <span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time =</span> time<span class="sc">/</span>reps, <span class="at">resolution =</span> resol)</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>}</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="do">## Values</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> </span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>    resolution <span class="sc">%&gt;%</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>    <span class="fu">map_df</span>(compute_times) </span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>fctr_order <span class="ot">&lt;-</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>    <span class="fu">unique</span>(comparison<span class="sc">$</span>resolution) <span class="sc">%&gt;%</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>    <span class="fu">paste</span>(., ., <span class="at">sep =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="do">## Plot</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>comparison <span class="sc">%&gt;%</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">resolution =</span> <span class="fu">paste</span>(resolution, resolution, <span class="at">sep =</span> <span class="st">&quot;x&quot;</span>),</span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>           <span class="at">resolution =</span> <span class="fu">ordered</span>(resolution, <span class="at">levels =</span> fctr_order)) <span class="sc">%&gt;%</span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(resolution, time, <span class="at">color =</span> FFT)) <span class="sc">+</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">shape =</span> FFT)) <span class="sc">+</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> FFT, <span class="at">group =</span> FFT)) <span class="sc">+</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;time (in seconds)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-1-recovering-standard-normal-from-its-characteristic-function" class="section level2">
<h2>Example 1: Recovering standard normal from its characteristic
function</h2>
<p>The density function of a random variable can be recovered using the
<a href="https://en.wikipedia.org/wiki/Fourier_inversion_theorem">Fourier
inversion theorem</a>. The characteristic function of a standard normal
distribution is <span class="math display">\[
\phi(t) = \exp(-t^2/2) \;\; t \in \mathbb{R}
\]</span></p>
<p>The due to the smoothness and symmetry of both, the characteristic
function and the standard normal density, it can be well approximated
even with a low resolution.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(fourierin)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="do">## Characteristic function of std. normal.</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>fnc <span class="ot">&lt;-</span> <span class="cf">function</span>(t) <span class="fu">exp</span>(<span class="sc">-</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="do">## Compute integral</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">fourierin</span>(<span class="at">f =</span> fnc, <span class="at">lower_int =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">upper_int =</span> <span class="dv">5</span>,</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>                 <span class="at">lower_eval =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">upper_eval =</span> <span class="dv">5</span>,</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>                 <span class="at">const_adj =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">freq_adj =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">resolution =</span> <span class="dv">64</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="do">## Extract values and compute true values of the density</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> out <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">values =</span> <span class="fu">Re</span>(values),</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>           <span class="at">density =</span> <span class="st">&quot;approximated&quot;</span>)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">w =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df1<span class="sc">$</span>w), <span class="fu">max</span>(df1<span class="sc">$</span>w), <span class="at">len =</span> <span class="dv">150</span>),</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>                  <span class="at">values =</span> <span class="fu">dnorm</span>(w),</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>                  <span class="at">density =</span> <span class="st">&quot;true&quot;</span>)</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="fu">bind_rows</span>(df1, df2) <span class="sc">%&gt;%</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(w, values, <span class="at">color =</span> density)) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> density)) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;x&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;f(x)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We now present a second example: recovering the density of a <span class="math inline">\(\chi^2\)</span> distribution using its
characteristic function. The corresponding density is not symmetric and
its support is not the entire real line, thus a higher resolution might
be required to achieve a good approximation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(fourierin)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="do">## Set functions</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">5</span>                                        </span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>cf <span class="ot">&lt;-</span> <span class="cf">function</span>(t) (<span class="dv">1</span> <span class="sc">-</span> 2i<span class="sc">*</span>t)<span class="sc">^</span>(<span class="sc">-</span>df<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>dens <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dchisq</span>(x, df)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="do">## Set resolutions</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>resolutions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="do">## Compute integral given the resoltion</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>recover_f <span class="ot">&lt;-</span> <span class="cf">function</span>(resol){</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>    <span class="do">## Get grid and density values</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">fourierin</span>(<span class="at">f =</span> cf, <span class="at">lower_int =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">upper_int =</span> <span class="dv">10</span>,</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>                     <span class="at">lower_eval =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">upper_eval =</span> <span class="dv">20</span>,</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>                     <span class="at">const_adj =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">freq_adj =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>                     <span class="at">resolution =</span> resol)</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>    <span class="do">## Return in dataframe format</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>    out <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>        <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>        <span class="fu">transmute</span>(</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>            <span class="at">x =</span> w,</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>            <span class="at">values =</span> <span class="fu">Re</span>(values),</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>            <span class="at">resolution =</span> resol)</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>}</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="do">## Density approximations</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">map_df</span>(resolutions, recover_f)</span></code></pre></div>
<pre><code>## Warning: `as_data_frame()` was deprecated in tibble 2.0.0.
## ℹ Please use `as_tibble()` (with slightly different semantics) to convert to a
##   tibble, or `as.data.frame()` to convert to a data frame.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="do">## True values</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>true <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fu">min</span>(vals<span class="sc">$</span>x), <span class="fu">max</span>(vals<span class="sc">$</span>x), <span class="at">length =</span> <span class="dv">150</span>),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                   <span class="at">values =</span> <span class="fu">dens</span>(x))</span></code></pre></div>
<pre><code>## Warning: `data_frame()` was deprecated in tibble 1.1.0.
## ℹ Please use `tibble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>vals <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">resolution =</span> <span class="fu">ordered</span>(resolution,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                                <span class="at">labels =</span> resolutions)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, values)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> resolution)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> true, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;true values&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2-computing-characteristic-function-of-a-gamma-density" class="section level2">
<h2>Example 2: Computing characteristic function of a gamma density</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">library</span>(fourierin)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="do">## Compute integral</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>myfnc <span class="ot">&lt;-</span> <span class="cf">function</span>(t) <span class="fu">dgamma</span>(t, shape, rate)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="do">## Function to compute characteristic function for a given resolution.</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>approximate_CF <span class="ot">&lt;-</span> <span class="cf">function</span> (resol) {</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">fourierin</span>(<span class="at">f =</span> myfnc, <span class="sc">-</span><span class="dv">0</span>, <span class="dv">8</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>, resol)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>    </span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>    out <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>        <span class="fu">as_data_frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>        <span class="fu">transmute</span>(<span class="at">t =</span> w,</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>                  <span class="at">real =</span> <span class="fu">Re</span>(values),</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>                  <span class="at">imaginary =</span> <span class="fu">Im</span>(values),</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>                  <span class="at">resolution =</span> <span class="fu">as.character</span>(resol)) <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>        <span class="fu">gather</span>(CF, values, <span class="sc">-</span>t, <span class="sc">-</span>resolution)</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>}</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="do">## Evaluate approxs. to CF for different resulutions</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>resolution <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>CF <span class="ot">&lt;-</span> <span class="fu">map_df</span>(resolution, approximate_CF)</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="do">## Evaluate true values of characteristic function</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a>true_cf <span class="ot">&lt;-</span> <span class="cf">function</span>(t, shape, rate) (<span class="dv">1</span> <span class="sc">-</span> 1i<span class="sc">*</span>t<span class="sc">/</span>rate)<span class="sc">^-</span>shape</span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a>true <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="fu">min</span>(CF<span class="sc">$</span>t), <span class="fu">max</span>(CF<span class="sc">$</span>t), <span class="at">length =</span> <span class="dv">150</span>),</span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a>                   <span class="at">values =</span> <span class="fu">true_cf</span>(t, shape, rate),</span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a>                   <span class="at">real =</span> <span class="fu">Re</span>(values),</span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a>                   <span class="at">imaginary =</span> <span class="fu">Im</span>(values),</span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>                   <span class="at">resolution =</span> <span class="st">&quot;true values&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>values) <span class="sc">%&gt;%</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a>    <span class="fu">gather</span>(CF, values, <span class="sc">-</span>t, <span class="sc">-</span>resolution)</span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="do">## Plot values</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a>CF <span class="sc">%&gt;%</span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, values, <span class="at">color =</span> resolution,</span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>               <span class="at">group =</span> resolution)) <span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> true) <span class="sc">+</span> </span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>CF) <span class="sc">+</span> </span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3-recovering-std.-normal-from-its-characteristic-function" class="section level2">
<h2>Example 3: Recovering std. normal from its characteristic
function</h2>
<p>Testing example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="do">## Load packages</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">library</span>(fourierin)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="do">## Set functions to be tested with their corresponding parameters.</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="do">## Multivariate normal density, x is n x d</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>    <span class="do">## Auxiliar values</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">sweep</span>(x, <span class="dv">2</span>, mu, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>    <span class="do">## Get numerator and denominator of normal density</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">rowSums</span>(z <span class="sc">*</span> (z <span class="sc">%*%</span> <span class="fu">solve</span>(sig))))</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>    denom <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">^</span>d<span class="sc">*</span><span class="fu">det</span>(sig))</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>    <span class="fu">return</span>(num<span class="sc">/</span>denom)</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>}</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="do">## Characteristic function, s is n x d</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="cf">function</span> (s) {</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>    <span class="fu">complex</span>(<span class="at">modulus =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">rowSums</span>(s<span class="sc">*</span>(s <span class="sc">%*%</span> sig))),</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>            <span class="at">argument =</span> s <span class="sc">%*%</span> mu)</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>}</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="do">## Evaluate characteristic function for a given resolution.</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>eval <span class="ot">&lt;-</span> <span class="fu">fourierin</span>(f,</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>                  <span class="at">lower_int =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="sc">-</span><span class="dv">6</span>), <span class="at">upper_int =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>),</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>                  <span class="at">lower_eval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>), <span class="at">upper_eval =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>                  <span class="at">const_adj =</span> <span class="dv">1</span>, <span class="at">freq_adj =</span> <span class="dv">1</span>, <span class="at">resolution =</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">64</span>, <span class="dv">64</span>),</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>                  <span class="at">use_fft =</span> T)</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="do">## --- Little test</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a>dat <span class="ot">&lt;-</span> eval <span class="sc">%&gt;%</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>    <span class="fu">with</span>(<span class="fu">crossing</span>(<span class="at">y =</span> w2, <span class="at">x =</span> w1) <span class="sc">%&gt;%</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">approximated =</span> <span class="fu">c</span>(values))) <span class="sc">%&gt;%</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">true =</span> <span class="fu">phi</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(x, y), <span class="at">ncol =</span> <span class="dv">2</span>)),</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a>           <span class="at">difference =</span> approximated <span class="sc">-</span> true) <span class="sc">%&gt;%</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a>    <span class="fu">gather</span>(value, z, <span class="sc">-</span>x, <span class="sc">-</span>y) <span class="sc">%&gt;%</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">real =</span> <span class="fu">Re</span>(z), <span class="at">imaginary =</span> <span class="fu">Im</span>(z)) <span class="sc">%&gt;%</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>z) <span class="sc">%&gt;%</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a>    <span class="fu">gather</span>(part, z, <span class="sc">-</span>x, <span class="sc">-</span>y, <span class="sc">-</span>value)</span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="do">## Surface plot</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="fu">wireframe</span>(z <span class="sc">~</span> x<span class="sc">*</span>y <span class="sc">|</span> value<span class="sc">*</span>part, <span class="at">data =</span> dat,          </span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a>          <span class="at">scales =</span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a>              <span class="fu">list</span>(<span class="at">arrows=</span><span class="cn">FALSE</span>, <span class="at">cex=</span> <span class="fl">0.45</span>,</span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a>                   <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">font =</span> <span class="dv">3</span>, <span class="at">tck =</span> <span class="dv">1</span>),</span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a>          <span class="at">screen =</span> <span class="fu">list</span>(<span class="at">z =</span> <span class="dv">90</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">74</span>),</span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a>          <span class="at">colorkey =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a>          <span class="at">shade=</span><span class="cn">TRUE</span>,</span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a>          <span class="at">light.source=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">10</span>),</span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a>          <span class="at">shade.colors =</span> <span class="cf">function</span>(irr, ref,</span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a>                                  height, <span class="at">w =</span> <span class="fl">0.4</span>)</span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a>              <span class="fu">grey</span>(w<span class="sc">*</span>irr <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> w)<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> ref)<span class="sc">^</span><span class="fl">0.4</span>)),</span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a>          <span class="at">aspect =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.65</span>))</span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a><span class="do">## Contours of values</span></span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a>    <span class="fu">filter</span>(value <span class="sc">!=</span> <span class="st">&quot;difference&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">z =</span> z)) <span class="sc">+</span></span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> z)) <span class="sc">+</span></span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a>    <span class="fu">facet_grid</span>(part <span class="sc">~</span> value) <span class="sc">+</span></span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a>    <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Reds&quot;</span>)</span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a></span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a><span class="do">## Contour of differences</span></span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a>    <span class="fu">filter</span>(value <span class="sc">==</span> <span class="st">&quot;difference&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">z =</span> z)) <span class="sc">+</span></span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> z)) <span class="sc">+</span></span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a>    <span class="fu">facet_grid</span>(part <span class="sc">~</span> value) <span class="sc">+</span></span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a>    <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
